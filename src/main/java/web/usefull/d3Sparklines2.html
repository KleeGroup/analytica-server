<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<script type="text/javascript" src="http://d3js.org/d3.v3.js"></script>
		<style type="text/css">
			path {
				stroke: #808080;
				stroke-width: 1;
				fill: none;
			}

			.area{
				fill: #ADD8E6;                  
    			stroke-width: 0px;     
			}

			.line {
				 fill: none;
				 stroke: #444;
				 stroke-width: 1.5px;
			}

			div.tooltip {
			  position: absolute;
			  text-align: center;
			  width: 60px;
			  height: 12px;
			  padding: 8px;
			  font: 10px sans-serif;
			  background: #ddd;
			  border: solid 1px #aaa;
			  border-radius: 8px;
			  pointer-events: none;
			}

			.legend {
				padding: 5px;
				font: 10px sans-serif;
				background: #CCC;
				box-shadow: 2px 2px 1px #888;
			}
			
			.bar:hover { 
   				 fill: orange !important;
			}
		</style>
	</head>

	<body>
		<div>
			<ul>
				<li class = "test">Serie1</li>
				<li class = "test">Serie2</li> 
				<li class = "test"> Serie3</li>
				<li id = "box3">Serie4</li>
				<li id = "box4" >Serie5</li>
			</ul>
		</div>		
 		<div id = "box5">
 		</div>
 		<!--Script for line sparklines-->
		<script type="text/javascript">
		var drawLine = function drawLine(data,id){
			var spacing = 3;
			var height = 15;
			//--------------------------------------------------------------------------------------
			var width = spacing*data.length;
			var graph = d3.select("#"+id).append("svg")
				.attr("width", width)
				.attr("height", height);
			// X scale will fit values from 0-10 within pixels 0-100
			var x = d3.scale.linear()
				.domain([0, data.length])
				.range([0, width]); 
			// Y scale will fit values from 0-10 within pixels 0-100
			var y = d3.scale.linear()
				.domain([0, d3.max(data)])
				.range([0, height]);
	 
			// create a line object that represents the SVN line we're creating
			var line = d3.svg.line()
				.x(function(d,i) { return x(i);})
				.y(function(d) { return height-y(d);})

			var area = d3.svg.area()
				.x(function(d,i) { return x(i);})
				.y0(height)
				.y1(function(d) { return height-y(d);})

			// display the line by appending an svg:path element with the data line we created above
		

			graph.append("svg:path").attr("d", line(data));
			graph.append("svg:path").datum(data).attr("class", "area").attr("d", area);
			
			graph.selectAll("dot")
			.data(data)
			.enter().append("circle")
			.filter(function(d,i) { return i ==data.length-1;}) // <== This line
				.style("fill", "red") // <== and this one
				.attr("r", 3.5)
				.attr("cx", function(d,i) { return width; })
				.attr("cy", function(d) { return height-y(d); });
		}
		</script>
 		<!--Script for bar sparklines-->
		<script type="text/javascript">
		var drawBar = function (data,id){
			var space = 1; // space between the bars
			var barWidth = 3;
			var height = 10;
			//----------------------------------------
			var	width = (barWidth+space) * data.length;
			var y = d3.scale.linear()
				.domain([0, d3.max(data)])
				.range([0, height]);

			var rectangle = d3.selectAll(("."+id)).append("svg")
				.attr("width", width)
				.attr("height", height)
				.attr("class","bar"); 

			var rectangle = rectangle.selectAll("rect")
				.data(data)
				.enter().append("rect")
					.attr("class", "bar")
					.attr("width", barWidth)
					.attr("height", y)
					.attr("y", function(d) {return height-y(d) ;})
					.attr("x", function(d, i) {return i * (barWidth+space);})
					.style("fill", function(d, i) { return i==(data.length-1)? "#C00" : "#09C";})
					.append("title").text(function(d) {return d;});
		}
		</script>

 		<!--Script for bar and line chart-->
		<script type="text/javascript">
		/*
			data = {bar:[],
					line:[]
					}
		*/

		var drawBrAndLine = function(datas,id){
			var margin = {top: 50, right: 50, bottom: 50, left: 50};
			var space = 5; // space between the bars
			var color_hash = {  
				0 : ["Response Time", "#09C"],
				1 : ["Hits", "black"]
			 };                 

			var height = 300;
			//var	width = (barWidth+space) * (datas[0].values).length;
			var width = 600;
			//----------------------------------------
			//var barWidth = 25;
			var barWidth = width/(datas[0].values).length - space;
			var x = d3.time.scale()
				.range([0, width]);

			var parseDate = d3.time.format("%d-%b-%y").parse;

			x.domain([
				new Date(d3.min(datas[1].values, function(d) {return d[0];})),
				new Date(d3.max(datas[1].values, function(d) {return d[0];})+3600000 )
				]);

			var y0 = d3.scale.linear()
				.domain([0, d3.max(datas[0].values, function(d) {return d[1];})])
				.range([height, 0]);

			var y1 = d3.scale.linear()
				.domain([0, d3.max(datas[1].values, function(d) {return d[1];})])
				.range([height, 0]);

			var xAxis = d3.svg.axis()
				.scale(x)
				.orient("bottom");

			var yLeftAxis = d3.svg.axis()
				.scale(y0)
				.orient("left");

			var yRightAxis = d3.svg.axis()
				.scale(y1)
				.orient("right");
			
			var graph = d3.select(("#"+id)).append("svg")
				.attr("width", width + margin.left + margin.right)
				.attr("height", height + margin.top + margin.bottom)
				.append("g")
				.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

			var div = d3.select("#"+id).append("div")
			    .attr("class", "tooltip")
			    .style("opacity", 1e-6);

			graph.append("g")
				.attr("class", "x axis")
				.attr("transform", "translate(0," + height + ")")
				.call(xAxis)
				.selectAll("text")  
					.style("text-anchor", "end")
					.attr("dx", "-.8em")
					.attr("dy", ".15em")
					.attr("transform", function(d) {return "rotate(-25)"});

			graph.append("g")
				.attr("class", "y axis")
				.attr("fill","#808080")
				.call(yLeftAxis)
				.append("text")
			    .attr("transform", "rotate(-90)")
			    .attr("y", 2)
			    .attr("dy", ".71em")
		      	.style("text-anchor", "end")
		      	.text(datas[0].key);

			graph.append("g")             
					.attr("class", "y axis")    
					.attr("transform", "translate(" + width + " ,0)")   
					.style("fill", "#808080")       
					.call(yRightAxis)
					.append("text")
					.attr("transform", "rotate(-90)")
					.attr("y", -15)
					.attr("dy", ".71em")
					.style("text-anchor", "end")
					.text(datas[1].key);

			var rectangle = graph.selectAll("rect")
				.data(datas[0].values)
				.enter().append("rect")
					.attr("width", barWidth)
					.attr("height", function(d) {return height-y0(d[1]);})
					.attr("y", function(d){return y0(d[1])})
					.attr("x", function(d, i) {return x((new Date(d[0])));})
					.style("fill", function(d) {return color_hash[0][1];})		
					.attr("class", "bar")
					//.append("title").text(function(d) {return d[1];})
					.on("mouseover", function(d){div.transition().duration(500).style("opacity", 1)})
					.on("mousemove", function(d){div.text(d[1]).style("left", (d3.event.pageX - 34) + "px").style("top", (d3.event.pageY - 50) + "px");})
					.on("mouseout", function(d){div.transition().duration(500).style("opacity", 1e-6);});	

			var line = d3.svg.line()
				.x(function(d,i) { return x(new Date(d[0]));})
				.y(function(d) { return y1(d[1]);})
				.interpolate("basis"); // spline interpollation

			graph.append("path")
				.datum(datas[1].values)
				.attr("class", "line")
				.attr("d", line);

			var legend = graph.append("g")
				.attr("class", "legend")
				.attr("transform", "translate(" + (width/2 + 100) + " ,"+ (-margin.top)+")");
			
			legend.append("rect")
				.attr("height", 40)
				.attr("width", 180)
				.attr("rx", 6)
				.attr("ry", 6)
				.attr("transform", "translate(-20,10)")
				.style("fill", "#EEE");

			legend.selectAll('legend')
				.data(datas)
				.enter().append("rect")
					.attr("y", margin.top/2)
					.attr("x", function(d, i){return i * 100;})
					.attr("width", 10)
					.attr("height", 10)
					.style("fill", function(d, i) {return color_hash[i][1];});

			legend.selectAll('legend')
				.data(datas)
				.enter().append("text")
					.attr("y", margin.top/2+10)
					.attr("x", function(d, i){return i *100 + 20;})
					.text(function(d) {return color_hash[datas.indexOf(d)][0];});
		}
		</script>

		<script type="text/javascript">
			var data = ["1", "2", "3", "4", "5", "10", "9", "8", "7", "6"];
			drawBar(data,"test");

			/*data = [1, 2, 3, 4, 5, 10, 9, 8, 7, 6,5,8,9,2,15,6,5,5,8,25];
			drawBar(data,"box1");

			data = [15, 2, 21, 8, 13, 11, 9, 10, 7, 17,22,8,14,25,5,11,5,18,8,25,4,19,2,20,8,0,1,2,9,5,4];
			drawBar(data,"box2");

			data = [45000, 24000, 30000, 78000, 100000, 58000, 64000];
			drawBar(data,"box3");*/

			//the line sparkline
			data = [15, 2, 21, 8, 13, 11, 9, 10, 7, 17,22,8,14,25,5,11,5,18,8,25,4,19,2,20,8,0,1,2,9,5,4];
			drawLine(data,"box4");

			var data1 = [ [ 3625200000 , 1214] , [ 3628800000 , 285] , [ 3632400000 , 455] , [ 3636000000 , 125] , [ 3639600000 , 1850] , [ 3643200000 , 789] , [ 3646800000 , 458] , [ 3650400000 , 999] , [ 3654000000 , 775] , [ 3657600000 , 328] , [ 3661200000 , 389],[3664800000,552],[3668400000,566],[3672000000,398],[3675600000,455],[3679200000,566],[3682800000,635],[3686400000,985],[3690000000,777],[3693600000,1000],[3697200000,989],[3700800000,1245],[3704400000,522],[3708000000,1360]];

			var data2 = [ [ 3625200000 , 145] , [ 3628800000 , 285] , [ 3632400000 , 455] , [ 3636000000 , 15] , [ 3639600000 , 510] , [ 3643200000 , 89] , [ 3646800000 , 58] , [ 3650400000 , 99] , [ 3654000000 , 75] , [ 3657600000 , 28] , [ 3661200000 , 39],[3664800000,52],[3668400000,566],[3672000000,398],[3675600000,455],[3679200000,566],[3682800000,35],[3686400000,85],[3690000000,77],[3693600000,100],[3697200000,89],[3700800000,125],[3704400000,22],[3708000000,30]];


			var datas = {
				bar:data1,
				line:data2
			}
			var datas = [{
				color:"#09C",
				key:"resp Time",
				values:data1
			},{
				color:"#F00",
				key:"Hits",
				values:data2
			}]

			drawBrAndLine(datas,"box5");
		</script>
	</body>
</html>